<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BloonsBench</title>
    <style>
      html, body { margin: 0; padding: 0; background: #111; }
      #container { width: 960px; height: 720px; margin: 12px auto; }
    </style>
    <script src="./ruffle.js"></script>
  </head>
  <body>
    <div id="container"></div>

    <script>
      const params = new URLSearchParams(window.location.search);
      const swfUrl = params.get('swf');
      if (!swfUrl) throw new Error('Missing ?swf= URL param');

      window.RufflePlayer = window.RufflePlayer || {};
      window.RufflePlayer.config = {
        renderer: "canvas",
        autoplay: "on",
      };
      const ruffle = window.RufflePlayer.newest();
      const player = ruffle.createPlayer();
      player.style.width = '100%';
      player.style.height = '100%';
      document.getElementById('container').appendChild(player);

      const defer = params.get('defer') === '1';
      window.__BLOONSBENCH__ = {
        player,
        deferred: defer,
        loaded: false,
        loadGame: function() {
          if (!this.loaded) {
            this.loaded = true;
            player.ruffle().load({ url: swfUrl });
          }
        }
      };

      if (!defer) {
        window.__BLOONSBENCH__.loadGame();
      }
    </script>
  </body>
</html>
